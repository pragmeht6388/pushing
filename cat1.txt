using System;
using System.Threading;

namespace ALDQuote.Carpolicy.Consumer
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            var cancellationTokenSource = new CancellationTokenSource();
            Console.CancelKeyPress += (sender, e) =>
            {
                e.Cancel = true;
                cancellationTokenSource.Cancel();
                Console.WriteLine("Cancellation requested. Shutting down...");
            };

            RabbitMQConsumer client = new RabbitMQConsumer();
            RabbitMQConsumer.CreateConnection();
            client.ProcessMessages(cancellationTokenSource.Token);
            client.Close();
        }
    }
}



public void ProcessMessages(CancellationToken cancellationToken)
{
    while (!cancellationToken.IsCancellationRequested)
    {
        GetMessageFromQueue();
    }
    Console.WriteLine("Message processing has been gracefully stopped.");
}
